import{u as P,i as N,r as w,o as $,b as E,c as m,e as f,j as n,f as r,w as a,q as F,g as M,h as i,Q as z,k as D,z as x,A as Q,F as h,t as y,n as c,l as d,p as G,s as H,v as J,x as K,y as O,m as k,C,aF as g,G as W,H as X,I as Y}from"./app.ff365efa.js";import{Q as I}from"./QTd.e7d61835.js";import{a as R}from"./QSelect.ed43419b.js";import{Q as Z}from"./QTr.974f864a.js";import{Q as ee}from"./QTable.7e35adf2.js";import{Q as te}from"./QSlideTransition.c83c83f9.js";import{_ as se}from"./_plugin-vue_export-helper.cdc0426e.js";import"./QItemLabel.a1c5c8ff.js";import"./QSeparator.0397bb17.js";import"./QMarkupTable.2aa3e877.js";import"./QLinearProgress.08299899.js";import"./QCheckbox.ab9a2b19.js";import"./use-checkbox.17e710c8.js";const U=p=>(X("data-v-97615053"),p=p(),Y(),p),ae={class:"q-ma-md"},le={class:"row justify-between"},oe={class:"col-8"},re=U(()=>n("div",{class:"row full-width flex-center q-pt-xs myRoundTop bg-primary"},[n("div",{class:"col-12 flex flex-center"},[n("span",{class:"text-h4"},"Users")])],-1)),ne={class:"row full-width q-pt-md justify-between"},ie={class:"col-auto"},de={class:"row q-gutter-sm q-pl-md"},ue={class:"col-3"},ce=U(()=>n("h4",{class:"no-margin"},"Filter By Roles",-1)),pe={__name:"AdminPanel",setup(p){M(e=>({"71e55720":j.value}));let s=P(),_=N("can"),v=w();$(async()=>{Echo.private("userupdate").listen("UserUpdate",e=>{this.refresh}),_("view_admin_logs")&&await s.getLoggingAdmin(),await s.getUsers(),await s.getRoles()}),E(async()=>{Echo.leave("userupdate")});let L=w({sortBy:"name",descending:!1,page:1,rowsPerPage:50}),b=m(()=>{let e=0;for(let l=0;l<s.rolesList.length;l++)s.rolesList[l].selected===!0&&e++;return e}),S=()=>{for(let e=0;e<s.rolesList.length;e++)s.rolesList[e].selected=!1};m(()=>s.rolesList.filter(e=>e.selected==!0));let q=m(()=>b.value?s.users.filter(l=>{const t=l.roles.map(o=>o.id);return s.rolesList.some(o=>o.selected&&t.includes(o.value))}):s.users),T=async(e,l)=>{var t={roleId:l,userId:e};await axios({method:"put",url:"/api/rolesremove",withCredentials:!0,data:t,headers:{Accept:"application/json","Content-Type":"application/json"}}),s.getUsers()},A=async(e,l)=>{var t={roleId:e,userId:l};await axios({method:"put",url:"/api/rolesadd",withCredentials:!0,data:t,headers:{Accept:"application/json","Content-Type":"application/json"}}),s.getUsers()},B=w([{name:"name",align:"left",required:!1,label:"Name",classes:"text-no-wrap",field:e=>e.name,format:e=>`${e}`,sortable:!1},{name:"roles",required:!0,align:"center",label:"Roles",classes:"text-no-wrap",style:"width: 80%",field:e=>e.id,format:e=>`${e}`,sortable:!1,filter:!0}]),j=m(()=>{let e=30;return s.size.height-e+"px"});return(e,l)=>(i(),f("div",ae,[n("div",le,[n("div",oe,[r(ee,{title:"Connections",class:"myTableUsers myRound bg-webBack",rows:q.value,columns:B.value,"table-class":" text-webway","table-header-class":" text-weight-bolder","row-key":"id",dark:"",dense:"",filter:v.value,ref:"tableRef",rounded:"",pagination:L.value},{top:a(t=>[re,n("div",ne,[n("div",ie,[n("div",de,[r(z,{rounded:"",standout:"",dense:"",debounce:"300",modelValue:v.value,"onUpdate:modelValue":l[0]||(l[0]=o=>v.value=o),clearable:"",placeholder:"Search"},{append:a(()=>[r(D,{name:"fa-solid fa-magnifying-glass"})]),_:1},8,["modelValue"])])])])]),body:a(t=>[r(Z,{props:t},{default:a(()=>[r(I,{key:"name",props:t},{default:a(()=>[x(Q(t.row.name),1)]),_:2},1032,["props"]),r(I,{key:"roles",props:t},{default:a(()=>[(i(!0),f(h,null,y(t.row.roles,(o,u)=>(i(),c(R,{key:u,removable:d(_)("super"),onRemove:V=>d(T)(t.row.id,o.id),color:"primary",label:o.name},null,8,["removable","onRemove","label"]))),128)),d(_)("super")?(i(),c(k,{key:0,round:"",color:"green",flat:"",icon:"fa-solid fa-plus"},{default:a(()=>[r(G,null,{default:a(()=>[r(H,{style:{"min-width":"100px"}},{default:a(()=>[(i(!0),f(h,null,y(d(s).rolesList,(o,u)=>J((i(),c(K,{key:u,clickable:""},{default:a(()=>[r(O,{onClick:V=>d(A)(o.value,t.row.id)},{default:a(()=>[x(Q(o.text),1)]),_:2},1032,["onClick"])]),_:2},1024)),[[W]])),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)):C("",!0)]),_:2},1032,["props"])]),_:2},1032,["props"])]),_:1},8,["rows","columns","filter","pagination"])]),n("div",ue,[r(F,{class:"myRoundTop"},{default:a(()=>[r(g,{class:"bg-primary text-h5 text-center"},{default:a(()=>[ce]),_:1}),r(g,null,{default:a(()=>[(i(!0),f(h,null,y(d(s).rolesList,(t,o)=>(i(),c(R,{key:o,color:"primary",outline:!t.selected,selected:t.selected,"onUpdate:selected":u=>t.selected=u,label:t.text},null,8,["outline","selected","onUpdate:selected","label"]))),128))]),_:1}),r(te,null,{default:a(()=>[b.value?(i(),c(g,{key:0},{default:a(()=>[r(k,{color:"primary",label:"Clear",onClick:l[1]||(l[1]=t=>d(S)())})]),_:1})):C("",!0)]),_:1})]),_:1})])])]))}},Ie=se(pe,[["__scopeId","data-v-97615053"]]);export{Ie as default};
