import{n as be,r as u,p as ge,v as R,w as ye,x as he,e as s,c as C,a,y as n,z as Te,_ as A,o as g,A as r,B as G,Q as Ce,C as d,L as k,ay as $,az as S,M as p,O as m,S as J,N as q,R as K,D as W,F as ke,H as Ve,I as Le,J as De,K as X,E as Qe,aB as Fe,G as Re,aE as Y,U as Ae}from"./app.e311c8d7.js";import{Q as U}from"./QItemLabel.17844741.js";import{Q as B}from"./QToggle.3d167bef.js";import{Q as M,a as E}from"./QSelect.78285059.js";import{Q as Z}from"./QBtnToggle.764f4dc7.js";import{Q as c}from"./QTd.8bb5d284.js";import{Q as ee}from"./QTr.e0876c6f.js";import{Q as $e}from"./QTable.c1752f2a.js";import"./QCheckbox.7b391117.js";import"./QSeparator.58649ec0.js";import"./QMarkupTable.3f1d7c4b.js";import"./QLinearProgress.1c72e58b.js";const Se={class:"q-ma-md"},qe=r("div",{class:"row full-width flex-center q-pt-xs myRoundTop bg-primary"},[r("div",{class:"col-11 flex flex-center"},[r("span",{class:"text-h4"},"Towers")])],-1),Ue={class:"row full-width q-pt-md justify-between"},Be={class:"col-12"},Me={class:"row q-gutter-sm q-pl-md"},Ee={class:"col-1"},Oe={class:"col-2"},Pe={class:"text-xs"},He={class:"col-4"},je={class:"text-xs"},ze={class:"col-4"},Ne={class:"text-xs"},Ie={class:"row justify-end q-pt-sm"},Ge={class:"col"},Je={class:"col-auto"},Ke=["src"],We={key:0},Xe=["src"],Ye={class:"row flex-center"},Ze={class:"text-left"},et={key:0},tt=["src"],vt={__name:"Towers",setup(lt){Te(e=>({"74069bb9":xe.value}));let f=be(),V=u("");ge("can");let y=u(),h=u();R(()=>A(()=>import("./index.c5900ccf.js"),["assets/index.c5900ccf.js","assets/app.e311c8d7.js","assets/app.78479e83.css"]));const te=R(()=>A(()=>import("./AddTower.16de660a.js"),["assets/AddTower.16de660a.js","assets/app.e311c8d7.js","assets/app.78479e83.css","assets/QSelect.78285059.js","assets/QItemLabel.17844741.js","assets/QOptionGroup.6b948240.js","assets/QRadio.df007502.js","assets/QCheckbox.7b391117.js","assets/QToggle.3d167bef.js"])),le=R(()=>A(()=>import("./TowerMessage.41ec7a97.js"),["assets/TowerMessage.41ec7a97.js","assets/app.e311c8d7.js","assets/app.78479e83.css","assets/QBadge.386343d9.js","assets/QChatMessage.f3bb71e8.js","assets/TowerMessage.d96f5228.css"]));ye(async()=>{Echo.private("towers").listen("TowerChanged",e=>{f.updateTowers(e.flag.message)}).listen("TowerNew",e=>{f.getTowerData()}).listen("TowerDelete",e=>{f.deleteTower(e.flag.id)}).listen("TowerSheetMessageUpdate",e=>{f.updateTowers(e.flag.message)}),await f.getTowerData()}),he(async()=>{Echo.leave("towers")});let ae=u({sortBy:"region",descending:!1,page:1,rowsPerPage:0}),oe=u([{title:"New",value:1},{title:"Scouted",value:2},{title:"Online",value:4},{title:"Reffed",value:5},{title:"Anchored",value:9},{title:"Anchoring",value:3},{title:"Dead",value:6}]),ne=e=>{if(e==1)return"webway";if(e==2)return"secondary";if(e==3)return"warning";if(e==4)return"primary";if(e==5||e==6)return"negative";if(e==7)return"orange";if(e==8)return"warning";if(e==9)return"teal"},re=e=>{var o={text:e.text};Y({method:"put",url:"api/tower/updatetext/"+e.id,withCredentials:!0,data:o,headers:{Accept:"application/json","Content-Type":"application/json"}})},ie=e=>oe.value.filter(l=>l.value!=e),se=(e,o)=>{var l={status_id:o};Y({method:"put",url:"api/tower/updatestatus/"+e,withCredentials:!0,data:l,headers:{Accept:"application/json","Content-Type":"application/json"}})},O=s(()=>_.value.length>0?f.towers.filter(o=>_.value.some(l=>l.value===o.moon.region_id)):f.towers),P=s(()=>x.value.length>0?O.value.filter(o=>x.value.some(l=>l.value===o.moon.constellation_id)):O.value),v=s(()=>T.value.length>0?P.value.filter(o=>T.value.some(l=>l.value===o.item_id)):P.value),H=s(()=>y.value?y.value==1?v.value.filter(e=>e.corp.alliance_id?e.corp.alliance.standing<=0:e.corp.standing<=0):v.value.filter(e=>e.corp.alliance_id?e.corp.alliance.standing>0:e.corp.standing>0):v.value),ue=s(()=>h.value?H.value.filter(e=>e.status.id==h.value):H.value),de=s(()=>ue.value),_=u([]),L=u(),j=s(()=>{var e=v.value.map(t=>({id:t.moon.region.id,name:t.moon.region.region_name}));const o=[],l=new Map;for(const t of e)l.has(t.id)||(l.set(t.id,!0),o.push({value:t.id,text:t.name}));return o.sort((t,i)=>t.text.localeCompare(i.text)),o}),me=s(()=>L.value?j.value.filter(e=>e.text.toLowerCase().indexOf(L.value)>-1):j.value),ce=(e,o,l)=>{o(()=>{L.value=e.toLowerCase()})},x=u([]),D=u(),z=s(()=>{var e=v.value.map(t=>({id:t.moon.constellation.id,name:t.moon.constellation.constellation_name}));const o=[],l=new Map;for(const t of e)l.has(t.id)||(l.set(t.id,!0),o.push({value:t.id,text:t.name}));return o.sort((t,i)=>t.text.localeCompare(i.text)),o}),fe=s(()=>D.value?z.value.filter(e=>e.text.toLowerCase().indexOf(D.value)>-1):z.value),pe=(e,o,l)=>{o(()=>{D.value=e.toLowerCase()})},T=u([]),Q=u(),N=s(()=>{var e=v.value.map(t=>({id:t.item.id,type:t.item.item_name}));const o=[],l=new Map;for(const t of e)l.has(t.id)||(l.set(t.id,!0),o.push({value:t.id,text:t.type}));return o.sort((t,i)=>t.text.localeCompare(i.text)),o}),ve=s(()=>Q.value?N.value.filter(e=>e.text.toLowerCase().indexOf(Q.value)>-1):N.value),we=(e,o,l)=>{o(()=>{Q.value=e.toLowerCase()})},F=()=>{},_e=u([{name:"region",align:"left",required:!1,label:"Region",classes:"text-no-wrap",field:e=>e.moon.region.region_name,format:e=>`${e}`,sortable:!1},{name:"constellation",required:!0,align:"left",label:"Constellation",classes:"text-no-wrap",field:e=>e.moon.constellation.constellation_name,format:e=>`${e}`,sortable:!0,filter:!0},{name:"system",required:!0,align:"left",label:"System",classes:"text-no-wrap",field:e=>e.moon.system.system_name,format:e=>`${e}`,sortable:!0,filter:!0},{name:"corpTicker",align:"left",classes:"text-no-wrap",label:"Corp",field:e=>e.corp.ticker,format:e=>`${e}`,sortable:!0,filter:!0},{name:"allianceTicker",align:"left",required:!0,label:"Alliance",classes:"text-no-wrap",field:e=>e.corp.alliance?e.corp.alliance.ticker:null,format:e=>`${e}`,sortable:!0,filter:!0},{name:"moon",align:"left",classes:"text-no-wrap",label:"Moon",field:e=>e.moon.name,format:e=>`${e}`,sortable:!0,filter:!0},{name:"type",label:"Type",align:"left",classes:"text-no-wrap",field:e=>e.item.item_name,format:e=>`${e}`,sortable:!0,filter:!0},{name:"status",label:"Status",classes:"text-no-wrap",align:"center",sortable:!0,field:e=>e.status.name,format:e=>`${e}`},{name:"actions",label:"",align:"right",classes:"text-no-wrap",sortable:!1,field:e=>e.id,format:e=>`${e}`},{name:"editedBy",label:"Edited By",classes:"text-no-wrap",align:"right",sortable:!0,field:e=>e.user.name,format:e=>`${e}`}]),xe=s(()=>{let e=30;return f.size.height-e+"px"});return(e,o)=>(g(),C("div",Se,[a($e,{title:"Connections",class:"myTablePoS myRound bg-webBack",rows:de.value,columns:_e.value,"table-class":" text-webway","table-header-class":" text-weight-bolder","row-key":"id","no-data-label":"All Hostile Stations our reffed!!!!!!",dark:"",dense:"",filter:V.value,ref:"tableRef",rounded:"","hide-bottom":"",pagination:ae.value},{top:n(l=>[qe,r("div",Ue,[r("div",Be,[r("div",Me,[r("div",Ee,[a(G,{rounded:"",standout:"",dense:"",debounce:"300",modelValue:V.value,"onUpdate:modelValue":o[0]||(o[0]=t=>V.value=t),clearable:"",placeholder:"Search"},{append:n(()=>[a(Ce,{name:"fa-solid fa-magnifying-glass"})]),_:1},8,["modelValue"])]),r("div",Oe,[a(M,{rounded:"",dense:"",clearable:"",standout:"","input-debounce":"0","label-color":"webway","option-value":"value","option-label":"text",modelValue:_.value,"onUpdate:modelValue":o[1]||(o[1]=t=>_.value=t),options:me.value,ref:"toRegionRef",label:"Region",onClear:o[2]||(o[2]=t=>_.value=[]),onFilter:d(ce),onFilterAbort:d(F),"map-options":"","use-input":"","use-chips":"",multiple:"","input-style":" max-width: 10px; min-width: 10px"},{option:n(({itemProps:t,opt:i,selected:w,toggleOption:b})=>[a(k,$(S(t)),{default:n(()=>[a(p,null,{default:n(()=>[a(U,{innerHTML:i.text},null,8,["innerHTML"])]),_:2},1024),a(p,{side:""},{default:n(()=>[a(B,{"model-value":w,"onUpdate:modelValue":I=>b(i)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),"selected-item":n(t=>[a(E,{removable:"",onRemove:i=>t.removeAtIndex(t.index),tabindex:t.tabindex,"text-color":"white",class:"q-ma-none",color:"webChip"},{default:n(()=>[r("span",Pe,m(t.opt.text),1)]),_:2},1032,["onRemove","tabindex"])]),_:1},8,["modelValue","options","onFilter","onFilterAbort"])]),r("div",He,[a(M,{rounded:"",clearable:"",dense:"",standout:"","input-debounce":"0","label-color":"webway","option-value":"value","option-label":"text",modelValue:x.value,"onUpdate:modelValue":o[3]||(o[3]=t=>x.value=t),options:fe.value,ref:"toConstellationRef",label:"Constellations",onClear:o[4]||(o[4]=t=>x.value=[]),onFilter:d(pe),onFilterAbort:d(F),"map-options":"","use-input":"","use-chips":"",multiple:"","input-style":" max-width: 10px; min-width: 10px"},{option:n(({itemProps:t,opt:i,selected:w,toggleOption:b})=>[a(k,$(S(t)),{default:n(()=>[a(p,null,{default:n(()=>[a(U,{innerHTML:i.text},null,8,["innerHTML"])]),_:2},1024),a(p,{side:""},{default:n(()=>[a(B,{"model-value":w,"onUpdate:modelValue":I=>b(i)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),"selected-item":n(t=>[a(E,{removable:"",onRemove:i=>t.removeAtIndex(t.index),tabindex:t.tabindex,"text-color":"white",class:"q-ma-none",color:"webChip"},{default:n(()=>[r("span",je,m(t.opt.text),1)]),_:2},1032,["onRemove","tabindex"])]),_:1},8,["modelValue","options","onFilter","onFilterAbort"])]),r("div",ze,[a(M,{rounded:"",clearable:"",dense:"",standout:"","input-debounce":"0","label-color":"webway","option-value":"value","option-label":"text",modelValue:T.value,"onUpdate:modelValue":o[5]||(o[5]=t=>T.value=t),options:ve.value,ref:"typeRef",label:"Type",onFilter:d(we),onFilterAbort:d(F),"map-options":"","use-input":"","use-chips":"",multiple:"","input-style":" max-width: 10px; min-width: 10px"},{option:n(({itemProps:t,opt:i,selected:w,toggleOption:b})=>[a(k,$(S(t)),{default:n(()=>[a(p,null,{default:n(()=>[a(U,{innerHTML:i.text},null,8,["innerHTML"])]),_:2},1024),a(p,{side:""},{default:n(()=>[a(B,{"model-value":w,"onUpdate:modelValue":I=>b(i)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),_:2},1040)]),"selected-item":n(t=>[a(E,{removable:"",onRemove:i=>t.removeAtIndex(t.index),tabindex:t.tabindex,"text-color":"white",class:"q-ma-none",color:"webChip"},{default:n(()=>[r("span",Ne,m(t.opt.text),1)]),_:2},1032,["onRemove","tabindex"])]),_:1},8,["modelValue","options","onFilter","onFilterAbort"])])]),r("div",Ie,[r("div",Ge,[a(d(te))]),r("div",Je,[a(Z,{modelValue:y.value,"onUpdate:modelValue":o[6]||(o[6]=t=>y.value=t),rounded:"",unelevated:"",class:"q-pr-md",clearable:"",color:"webDark","text-color":"gray","toggle-color":"primary","toggle-text-color":"gray",options:[{label:"Hostile",value:1},{label:"Friendly",value:2}]},null,8,["modelValue"]),a(Z,{modelValue:h.value,"onUpdate:modelValue":o[7]||(o[7]=t=>h.value=t),rounded:"",unelevated:"",clearable:"",color:"webDark","text-color":"gray","toggle-color":"primary","toggle-text-color":"gray",options:[{label:"Scouting",value:2},{label:"Anchoring",value:3},{label:"Online",value:4},{label:"Reffed",value:5},{label:"Dead",value:6}]},null,8,["modelValue"])])])])])]),body:n(l=>[a(ee,{props:l},{default:n(()=>[a(c,{key:"region",props:l},{default:n(()=>[r("div",null,m(l.row.moon.region.region_name),1)]),_:2},1032,["props"]),a(c,{key:"constellation",props:l},{default:n(()=>[r("div",null,m(l.row.moon.constellation.constellation_name),1)]),_:2},1032,["props"]),a(c,{key:"system",props:l},{default:n(()=>[r("div",null,m(l.row.moon.system.system_name),1)]),_:2},1032,["props"]),a(c,{key:"corpTicker",props:l},{default:n(()=>[r("div",null,[a(J,{size:"md",class:"q-pa-none"},{default:n(()=>[r("img",{src:l.row.corp.url},null,8,Ke)]),_:2},1024),q(" "+m(l.row.corp.ticker),1)])]),_:2},1032,["props"]),a(c,{props:l,key:"allianceTicker"},{default:n(()=>[l.row.corp.alliance?(g(),C("div",We,[a(J,{size:"md",class:"q-pa-none"},{default:n(()=>[r("img",{src:l.row.corp.alliance.url},null,8,Xe)]),_:2},1024),q(" "+m(l.row.corp.alliance.ticker),1)])):K("",!0)]),_:2},1032,["props"]),a(c,{key:"moon",props:l},{default:n(()=>[r("div",null,m(l.row.moon.name),1)]),_:2},1032,["props"]),a(c,{key:"type",props:l},{default:n(()=>[r("div",null,m(l.row.item.item_name),1)]),_:2},1032,["props"]),a(c,{key:"status",props:l},{default:n(()=>[r("div",null,[a(W,{class:"myOutLineButtonLarge",color:d(ne)(l.row.status.id),size:"md",rounded:"",label:l.row.status.name},{default:n(()=>[a(ke,null,{default:n(()=>[a(Ve,{style:{"min-width":"100px"}},{default:n(()=>[(g(!0),C(Le,null,De(d(ie)(l.row.status.id),(t,i)=>X((g(),Qe(k,{key:i,onClick:w=>d(se)(l.row.id,t.value),clickable:""},{default:n(()=>[a(p,null,{default:n(()=>[q(m(t.title),1)]),_:2},1024)]),_:2},1032,["onClick"])),[[Ae]])),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["color","label"])])]),_:2},1032,["props"]),a(c,{key:"actions",props:l},{default:n(()=>[r("div",Ye,[a(d(le),{class:"q-pr-lg",tower:l.row,type:4},null,8,["tower"]),a(W,{"no-caps":"",color:"accent",label:"aDash",dense:"",onClick:t=>l.expand=!l.expand,outline:!l.row.text},null,8,["onClick","outline"])])]),_:2},1032,["props"]),a(c,{key:"editedBy",props:l},{default:n(()=>[r("div",null,m(l.row.user.name),1)]),_:2},1032,["props"])]),_:2},1032,["props"]),X(a(ee,{props:l},{default:n(()=>[a(c,{colspan:"100%"},{default:n(()=>[r("div",Ze,[a(G,{modelValue:l.row.text,"onUpdate:modelValue":[t=>l.row.text=t,t=>d(re)(l.row)],outlined:"",type:"text",label:"aDash Board Link - needs to be a link to a scan, making a new scan from where will not save",debounce:"300"},null,8,["modelValue","onUpdate:modelValue"]),l.row.text!=null&&l.row.text.includes("https://adashboard.info/intel/dscan/")?(g(),C("span",et,[a(Re,{class:"my-card"},{default:n(()=>[r("iframe",{src:l.row.text,frameborder:"0",style:{left:"0",bottom:"0",right:"0",width:"100%",height:"600px",border:"none",margin:"0",padding:"0",overflow:"hidden"}},null,8,tt)]),_:2},1024)])):K("",!0)])]),_:2},1024)]),_:2},1032,["props"]),[[Fe,l.expand]])]),_:1},8,["rows","columns","filter","pagination"])]))}};export{vt as default};
