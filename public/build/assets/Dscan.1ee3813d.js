import{d as w,u as W,i as X,ay as Y,az as aa,a as ea,r as h,o as ta,b as la,c as p,e as c,j as m,f as l,w as n,aA as sa,aB as na,C as _,B as oa,q as T,l as o,_ as x,h as d,n as L,aC as S,A as i,z as D,aD as A,Q as da,aE as ia,m as E,s as ca,F as ra,t as ua,x as B}from"./app.899e06bb.js";import{Q as ma,a as k}from"./QTabPanels.3e9b0096.js";import{Q as pa}from"./QChip.20f49286.js";const fa={class:"q-ma-md"},_a={class:"row q-gutter-lg"},va={key:0,class:"col-9"},ya={class:"col-2"},ga={key:0,class:"col-auto"},ha={class:"col text-h6"},Sa={class:"col text-h6"},ka={class:"col text-h6"},Ca={class:"col text-h6"},ba={key:0,class:"text-red"},wa={key:0},Ta={key:1},xa={key:1,class:"text-red"},La={key:1,class:"col-auto text-h6"},Da={key:2,class:"col-auto"},Ba={__name:"Dscan",setup(Va){const C=w(()=>x(()=>import("./DscanTotal.a501da84.js"),["assets/DscanTotal.a501da84.js","assets/app.899e06bb.js","assets/app.7b67968f.css"])),U=w(()=>x(()=>import("./DscanLocal.8c356cae.js"),["assets/DscanLocal.8c356cae.js","assets/app.899e06bb.js","assets/app.7b67968f.css","assets/QImg.64aa7343.js","assets/DscanLocal.c246d068.css"])),H=w(()=>x(()=>import("./index.d98df244.js"),["assets/index.d98df244.js","assets/app.899e06bb.js","assets/app.7b67968f.css"]));let e=W();X("can"),Y();let V=aa(),b=ea(),r=h(null),v=h(null),f=h(!1),g=h("total");ta(async()=>{document.title="Evestuff - Operations",r.value=V.params.link?V.params.link:null,Echo.private("dscanall").listen("DscanAllUpdate",a=>{a.flag.flag==1}),await I()}),la(()=>{Echo.leave("dscansolo."+r.value),Echo.leave("dscanall")});let I=async()=>{r.value&&(await e.getDscan(r.value),e.dScanIsHistory||Echo.private("dscansolo."+r.value).listen("dScanSoloUpdate",a=>{a.flag.flag==1,a.flag.flag==2&&(e.dScanLocalCorp=a.flag.message.corpsTotal,e.dScanLocalAlliance=a.flag.message.allianceTotal,e.updateLocalDscan(a.flag.message.soloLocal)),a.flag.flag==3&&(e.dScanLocalCorp=a.flag.message),a.flag.flag==4&&(e.dScanLocalAlliance=a.flag.message),a.flag.flag==5&&(e.dScan=a.flag.message,e.dScanHistory=a.flag.message.history),a.flag.flag==6&&(e.dScanIsHistory=a.flag.message)}))},j=p(()=>!!e.dScan),z=p(()=>e.dScan.system?e.dScan.system.system_name:"unknown"),O=p(()=>e.dScan.madeby?e.dScan.madeby.name:"unknown"),P=p(()=>e.dScan.updated_by?e.dScan.updated_by.name:"unknown"),R=p(()=>e.dScan.updated_at?e.dScan.updated_at:"unknown"),$=async()=>{f.value=!0;var a={text:v.value};await axios({method:"post",withCredentials:!0,data:a,url:"/api/dscan",headers:{Accept:"application/json","Content-Type":"application/json"}}).then(t=>{f.value=!1,b.push({path:`/dscan/${t.data.link}`})})},G=async()=>{f.value=!0;var a={text:v.value};await axios({method:"post",withCredentials:!0,data:a,url:"/api/dscan/"+r.value,headers:{Accept:"application/json","Content-Type":"application/json"}}).then(t=>{f.value=!1,console.log(t.data),e.dScanLocalCorp=t.data.data.corpsTotal,e.dScanLocalAlliance=t.data.data.allianceTotal,e.dScan=t.data.data.dscan,e.dScanHistory=t.data.data.dscan.history,v.value=null})},N=a=>{if(!a)return 0;let t=a,u=new Date(t).getTimezoneOffset()*6e4;return Date.parse(t)-u},q=p(()=>r.value?"full-height justify-between":"q-gutter-lg full-height justify-end");const M=a=>{const t=new Date(a),s={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"UTC"};return t.toLocaleString("en-US",s).replace(",","")};let F=a=>a==r.value,Z=a=>{b.push({path:`/dscan/${a}`})},J=()=>{b.push({path:`/dscan/${e.dScanLiveLink}`})},K=p(()=>{let a=70;return"height:"+(e.size.height-a+"px")});return(a,t)=>(d(),c("div",fa,[m("div",_a,[j.value?(d(),c("div",va,[l(sa,{dense:"",modelValue:g.value,"onUpdate:modelValue":t[0]||(t[0]=s=>g.value=s),class:"text-teal"},{default:n(()=>[o(e).dScan.locals?(d(),L(S,{key:0,name:"local",label:"Local"})):_("",!0),l(S,{name:"total",label:"Total"}),l(S,{name:"onGrid",label:"On Grid"}),l(S,{name:"offGrid",label:"Off Grid"})]),_:1},8,["modelValue"]),l(ma,{style:na(K.value),modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),animated:""},{default:n(()=>[l(k,{name:"local"},{default:n(()=>[l(o(U))]),_:1}),l(k,{name:"total"},{default:n(()=>[l(o(C),{type:1})]),_:1}),l(k,{name:"onGrid"},{default:n(()=>[l(o(C),{type:2})]),_:1}),l(k,{name:"offGrid"},{default:n(()=>[l(o(C),{type:3})]),_:1})]),_:1},8,["style","modelValue"])])):_("",!0),m("div",ya,[m("div",{class:oa([q.value,"column"])},[r.value?(d(),c("div",ga,[l(T,{class:"my-card"},{default:n(()=>[m("div",ha,"System: "+i(z.value),1),m("div",Sa,"Created By: "+i(O.value),1),m("div",ka,"Edited By: "+i(P.value),1),m("div",Ca,[D(" Last Updated: "),l(o(H),{class:"q-pl-sm","emit-events":!1,time:o(N)(R.value),interval:1e3},{default:n(({hours:s,minutes:u,seconds:y,days:Q})=>[s<=1&&Q==0?(d(),c("span",ba,[l(pa,{class:"",filter:"",pill:"",clickable:"",color:"primary","text-color":"white"},{default:n(()=>[s==1?(d(),c("span",wa,i(s)+":"+i(u)+":"+i(y),1)):(d(),c("span",Ta,i(u)+":"+i(y),1))]),_:2},1024)])):(d(),c("span",xa,[m("span",null,i(Q)+":"+i(s)+":"+i(u)+":"+i(y),1)]))]),_:1},8,["time"])])]),_:1})])):_("",!0),o(e).dScanIsHistory?_("",!0):(d(),c("div",La,[l(T,{class:"my-card myRoundTop"},{default:n(()=>[l(A,null,{default:n(()=>[l(da,{modelValue:v.value,"onUpdate:modelValue":t[2]||(t[2]=s=>v.value=s),type:"textarea",label:"Paste your Dscan or local here"},null,8,["modelValue"])]),_:1}),l(ia,{align:"center"},{default:n(()=>[l(E,{rounded:"",color:"primary",label:"New",loading:f.value,onClick:t[3]||(t[3]=s=>o($)())},null,8,["loading"]),l(E,{rounded:"",color:"secondary",label:"Update",loading:f.value,onClick:t[4]||(t[4]=s=>o(G)())},null,8,["loading"])]),_:1})]),_:1})])),o(e).dScanHistory||o(e).dScanIsHistory?(d(),c("div",Da,[l(T,{class:"my-card myRoundTop"},{default:n(()=>[l(A,null,{default:n(()=>[l(ca,{bordered:"",dense:""},{default:n(()=>[(d(!0),c(ra,null,ua(o(e).dScanHistory,(s,u)=>(d(),L(B,{clickable:"",onClick:y=>o(Z)(s.link),active:o(F)(s.link),key:u},{default:n(()=>[D(i(M(s.created_at)),1)]),_:2},1032,["onClick","active"]))),128)),o(e).dScanIsHistory?(d(),L(B,{key:0,clickable:"",onClick:t[5]||(t[5]=s=>o(J)())},{default:n(()=>[D(" Live ")]),_:1})):_("",!0)]),_:1})]),_:1})]),_:1})])):_("",!0)],2)])])]))}};export{Ba as default};
