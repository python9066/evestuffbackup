import{d as R,e as m,h as i,b2 as E,ae as W,ad as F,ag as G,ah as Z,y as J,r as j,o as p,c as b,a as r,w as u,al as y,b as H,t as h,aq as w,ab as S,am as K,a_ as B,ai as V,b3 as X,an as Y,ao as ee,aj as te,b0 as ae,at as ne,ak as d,Z as se,a$ as z,au as le}from"./app.b0420997.js";import{Q as ie}from"./QBadge.27dc9cbe.js";const oe=R({name:"QChatMessage",props:{sent:Boolean,label:String,bgColor:String,textColor:String,name:String,avatar:String,text:Array,stamp:String,size:String,labelHtml:Boolean,nameHtml:Boolean,textHtml:Boolean,stampHtml:Boolean},setup(e,{slots:n}){const l=m(()=>e.sent===!0?"sent":"received"),q=m(()=>`q-message-text-content q-message-text-content--${l.value}`+(e.textColor!==void 0?` text-${e.textColor}`:"")),g=m(()=>`q-message-text q-message-text--${l.value}`+(e.bgColor!==void 0?` text-${e.bgColor}`:"")),C=m(()=>"q-message-container row items-end no-wrap"+(e.sent===!0?" reverse":"")),$=m(()=>e.size!==void 0?`col-${e.size}`:""),x=m(()=>({msg:e.textHtml===!0?"innerHTML":"textContent",stamp:e.stampHtml===!0?"innerHTML":"textContent",name:e.nameHtml===!0?"innerHTML":"textContent",label:e.labelHtml===!0?"innerHTML":"textContent"}));function k(o){return n.stamp!==void 0?[o,i("div",{class:"q-message-stamp"},n.stamp())]:e.stamp?[o,i("div",{class:"q-message-stamp",[x.value.stamp]:e.stamp})]:[o]}function _(o,c){const f=c===!0?o.length>1?v=>v:v=>i("div",[v]):v=>i("div",{[x.value.msg]:v});return o.map((v,M)=>i("div",{key:M,class:g.value},[i("div",{class:q.value},k(f(v)))]))}return()=>{const o=[];n.avatar!==void 0?o.push(n.avatar()):e.avatar!==void 0&&o.push(i("img",{class:`q-message-avatar q-message-avatar--${l.value}`,src:e.avatar,"aria-hidden":"true"}));const c=[];n.name!==void 0?c.push(i("div",{class:`q-message-name q-message-name--${l.value}`},n.name())):e.name!==void 0&&c.push(i("div",{class:`q-message-name q-message-name--${l.value}`,[x.value.name]:e.name})),n.default!==void 0?c.push(_(E(n.default()),!0)):e.text!==void 0&&c.push(_(e.text)),o.push(i("div",{class:$.value},c));const f=[];return n.label!==void 0?f.push(i("div",{class:"q-message-label"},n.label())):e.label!==void 0&&f.push(i("div",{class:"q-message-label",[x.value.label]:e.label})),f.push(i("div",{class:C.value},o)),i("div",{class:`q-message q-message-${l.value}`},f)}}});const re={class:"text-h6"},ue={key:0},de={key:1},ge={__name:"RcStationMessage",props:{station:Object,type:Number},setup(e){const n=e;W("can");let l=F();const q=G(()=>Z(()=>import("./index.ed2e38aa.js"),["assets/index.ed2e38aa.js","assets/app.b0420997.js","assets/app.4ba9f0e4.css"]));J(async()=>{});let g=j(),C=j(!1);const $=async s=>{await z({method:"delete",url:"/api/sheetmessage/"+s,withCredentials:!0,headers:{Accept:"application/json","Content-Type":"application/json"}})},x=async()=>{const s={message:g.value};await z({method:"put",url:"/api/sheetmessage/"+n.station.id,withCredentials:!0,data:s,headers:{Accept:"application/json","Content-Type":"application/json"}}),g.value=null};let k=async()=>{l.stationChatWindowId=n.station.id},_=async()=>{g.value=null,l.stationChatWindowId=null},o=s=>new Date(s).getTime(),c=s=>{const a=new Date(s);return new Date-a<18e5},f=m(()=>Q.value.length),v=m(()=>l.getUnreadMessageCount(n.station.id)),M=m(()=>f.value?"fa-solid fa-message":"fa-regular fa-message"),D=s=>l.user_id==s,L=(s,a)=>l.user_id==a?"me":s,A=s=>l.user_id==s?"amber-7":"positive",I=m(()=>!g.value),Q=m(()=>l.getStationMessages(n.station.id)),U=s=>"https://image.eveonline.com/Character/"+s.user.eve_user_id+"_128.jpg";return(s,a)=>(p(),b("div",null,[r(S,{"text-color":"positive",icon:M.value,padding:"none",round:"",flat:"",onClick:a[0]||(a[0]=t=>C.value=!0)},{default:u(()=>[v.value&&!C.value?(p(),y(ie,{key:0,color:"red",floating:""},{default:u(()=>[H(h(v.value),1)]),_:1})):w("",!0)]),_:1},8,["icon"]),r(se,{modelValue:C.value,"onUpdate:modelValue":a[4]||(a[4]=t=>C.value=t),onBeforeShow:a[5]||(a[5]=t=>d(k)()),onBeforeHide:a[6]||(a[6]=t=>d(_)())},{default:u(()=>[r(K,{class:"my-card myRoundTop",style:{width:"1000px","max-height":"900px",height:"900px"}},{default:u(()=>[r(B,{class:"bg-primary myCardHeader text-center"},{default:u(()=>[V("div",re,"Notes for Station "+h(n.station.name),1)]),_:1}),r(B,{id:"messages",class:"overflow-auto",style:{height:"600px"}},{default:u(()=>[r(X,{"enter-active-class":"animate__animated animate__zoomIn"},{default:u(()=>[(p(!0),b(Y,null,ee(Q.value,(t,O)=>(p(),y(oe,{key:`${t.id}-message`,text:[t.message],name:d(L)(t.user.name,t.user_id),avatar:d(U)(t),sent:d(D)(t.user_id),"bg-color":d(A)(t.user_id)},{stamp:u(()=>[H("Sent: "),(p(),y(d(q),{key:`${t.id}-time`,interval:6e4,time:d(o)(t.created_at)},{default:u(({days:T,hours:N,minutes:P,seconds:me})=>[T!="00"?(p(),b("span",ue,h(T)+"days, ",1)):w("",!0),N!="00"?(p(),b("span",de,h(N)+"hours,",1)):w("",!0),V("span",null,h(P)+"minutes",1),H(" ago ")]),_:2},1032,["time"])),d(c)(t.created_at)&&d(D)(t.user_id)?(p(),y(S,{key:0,color:"negative",padding:"none",icon:"fa-solid fa-trash-can",flat:"",size:"xs",rounded:"",onClick:T=>$(t.id)},null,8,["onClick"])):w("",!0)]),_:2},1032,["text","name","avatar","sent","bg-color"]))),128))]),_:1})]),_:1}),r(B,null,{default:u(()=>[V("div",null,[r(te,{"input-style":"height: 150px",modelValue:g.value,"onUpdate:modelValue":a[1]||(a[1]=t=>g.value=t),clearable:"",outlined:"",rounded:"",dense:"",type:"textarea",label:"Message"},null,8,["modelValue"])])]),_:1}),r(ae,{align:"between"},{default:u(()=>[r(S,{rounded:"",label:"Submit",color:"primary",disable:I.value,onClick:a[2]||(a[2]=t=>x())},null,8,["disable"]),ne(r(S,{rounded:"",label:"Close",color:"negative",onClick:a[3]||(a[3]=t=>d(_)())},null,512),[[le]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]))}};export{ge as default};
