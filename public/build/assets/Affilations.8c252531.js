import{u as q,i as V,r as f,d as v,o as j,b as P,c as w,e as S,f as a,w as i,l as n,g as $,_ as g,h as R,j as s,m as c,A as D,p as L,q as F,aD as M,aE as N,v as h,G as b}from"./app.899e06bb.js";import{Q as m}from"./QTd.e4e8361b.js";import{Q as z}from"./QSelect.718038aa.js";import{Q as O}from"./QTable.6d8f68bb.js";import"./QChip.20f49286.js";import"./QItemLabel.f86d5f36.js";import"./QSeparator.704857b5.js";import"./QMarkupTable.f479a794.js";import"./QLinearProgress.2914627c.js";import"./QCheckbox.aa9ad5e8.js";import"./use-checkbox.e6acd31e.js";const U={class:"q-ma-md"},H={class:"row justify-between full-width flex-center q-pt-xs myRoundTop bg-primary"},I=s("div",{class:"col-auto"},null,-1),G=s("div",{class:"col-auto"},[s("span",{class:"text-h4"},"Affiliations")],-1),J={class:"col-auto"},K={class:"row"},W={class:"row"},X={class:"row"},fe={__name:"Affilations",setup(Y){$(e=>({"5ad75d88":E.value}));let l=q();V("can");let r=f();const _=v(()=>g(()=>import("./AffilationEditPannel.83de117b.js"),["assets/AffilationEditPannel.83de117b.js","assets/app.899e06bb.js","assets/app.7b67968f.css","assets/QOptionGroup.e84f4435.js","assets/QRadio.47a0d439.js","assets/use-checkbox.e6acd31e.js","assets/QCheckbox.aa9ad5e8.js","assets/QToggle.a04bd0c5.js"])),x=v(()=>g(()=>import("./AffilationAllianceChips.1de486b0.js"),["assets/AffilationAllianceChips.1de486b0.js","assets/app.899e06bb.js","assets/app.7b67968f.css","assets/QChip.20f49286.js"]));j(async()=>{l.getAffilationTable(),l.getAllianceTickList(),Echo.private("affilation").listen("AffilationUpdate",e=>{e.flag.flag==1&&l.updateAffilation(e.flag.message),e.flag.flag==2&&(l.affiliations=l.affiliations.filter(o=>o.id!=e.flag.message))})}),P(async()=>{Echo.leave("affilation")});let d=f(),u=w(()=>d.value?l.allianceticklist.filter(e=>e.text.toLowerCase().indexOf(d.value)>-1):l.allianceticklist),y=(e,o,t)=>{o(()=>{d.value=e.toLowerCase(),u.value.length>0&&e&&(r.value=u.value[0])})},A=async e=>{await axios({method:"delete",withCredentials:!0,url:"/api/affiliation/"+e,headers:{Accept:"application/json","Content-Type":"application/json"}}),l.affiliations=l.affiliations.filter(o=>o.id!=e)},C=async e=>{let o={alliance_id:r.value.value};await axios({method:"post",data:o,withCredentials:!0,url:"/api/affiliation/alliance/"+e,headers:{Accept:"application/json","Content-Type":"application/json"}}).then(t=>{l.updateAffilation(t.data.affiliation)})},k=()=>{r.value=null,d.value=null},T=f([{name:"name",align:"left",required:!1,label:"Name",classes:"text-no-wrap",field:e=>e.name,format:e=>`${e}`,sortable:!1},{name:"short_name",required:!0,align:"left",label:"Short",classes:"text-no-wrap",field:e=>e.short_name,format:e=>`${e}`,sortable:!1,filter:!0},{name:"color",required:!0,align:"left",label:"Color",classes:"text-no-wrap",field:e=>e.color,format:e=>`${e}`,sortable:!1,filter:!0},{name:"alliances",required:!0,align:"center",label:"Alliances",classes:"text-no-wrap",style:"width: 80%",field:e=>e.id,format:e=>`${e}`,sortable:!1,filter:!0},{name:"actions",required:!0,align:"right",label:"",classes:"text-no-wrap",field:e=>e.id,format:e=>`${e}`,sortable:!1,filter:!0}]),Q=e=>{if(e==0)return"Neutral";if(e==1)return"Red";if(e==2)return"Blue"},B=f({sortBy:"id",descending:!1,page:1,rowsPerPage:0}),E=w(()=>{let e=30;return l.size.height-e+"px"});return(e,o)=>(R(),S("div",U,[a(O,{title:"Connections",class:"myAffilationsTable myRound bg-webBack",rows:n(l).affiliations,columns:T.value,"table-class":" text-webway","table-header-class":" text-weight-bolder","row-key":"id",dark:"",dense:"",ref:"tableRef",rounded:"",pagination:B.value},{top:i(t=>[s("div",H,[I,G,s("div",J,[a(n(_))])])]),"body-cell-actions":i(t=>[a(m,{props:t},{default:i(()=>[s("div",K,[a(n(_),{edit:!0,item:t.row},null,8,["item"]),a(c,{color:"negative",padding:"none",size:"sm",flat:"",round:"",icon:"fa-solid fa-trash-alt",onClick:p=>n(A)(t.row.id)},null,8,["onClick"])])]),_:2},1032,["props"])]),"body-cell-color":i(t=>[a(m,{props:t},{default:i(()=>[s("div",W,D(n(Q)(t.row.color)),1)]),_:2},1032,["props"])]),"body-cell-alliances":i(t=>[a(m,{props:t},{default:i(()=>[s("div",X,[a(n(x),{item:t.row},null,8,["item"]),a(c,{color:"info",padding:"none",size:"sm",flat:"",round:"",icon:"fa-solid fa-plus"},{default:i(()=>[a(L,{onBeforeHide:n(k)},{default:i(()=>[a(F,{class:"my-card"},{default:i(()=>[a(M,null,{default:i(()=>[a(z,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=p=>r.value=p),options:u.value,"option-value":"value","option-label":"text",label:"Alliance Ticker",outlined:"",rounded:"","use-input":"",style:{width:"200px"},onFilter:n(y)},null,8,["modelValue","options","onFilter"])]),_:1}),a(N,{align:"between"},{default:i(()=>[h(a(c,{rounded:"",color:"positive",label:"Submit",onClick:p=>n(C)(t.row.id)},null,8,["onClick"]),[[b]]),h(a(c,{rounded:"",color:"negative",label:"Close"},null,512),[[b]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["onBeforeHide"])]),_:2},1024)])]),_:2},1032,["props"])]),_:1},8,["rows","columns","pagination"])]))}};export{fe as default};
